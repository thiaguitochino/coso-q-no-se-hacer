<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Notas - ABM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>

<div class="container mt-4">

    <!-- Botón Cargar Notas -->
    <div class="d-flex justify-content-center mb-4">
        <form method="GET" action="">
            <button type="submit" name="cargar_notas" class="btn btn-primary btn-lg">Cargar Notas</button>
        </form>
    </div>

    <?php
    $conn = new mysqli("localhost", "root", "", "escueladb");
    if ($conn->connect_error) {
        die('<div class="alert alert-danger">Error de conexión: ' . $conn->connect_error . '</div>');
    }

    // Mostrar notas al presionar el botón
    if (isset($_GET['cargar_notas'])) {
        $sql_notas = "SELECT id, nombre, apellido, materia, nota FROM notas ORDER BY id DESC";
        $resultado_notas = $conn->query($sql_notas);

        if ($resultado_notas && $resultado_notas->num_rows > 0) {
            echo '<table class="table table-striped table-bordered mt-4">';
            echo '<thead class="table-dark">';
            echo '<tr><th>ID</th><th>Nombre</th><th>Apellido</th><th>Materia</th><th>Nota</th></tr>';
            echo '</thead><tbody>';
            while ($fila = $resultado_notas->fetch_assoc()) {
                echo '<tr>';
                echo '<td>' . htmlspecialchars($fila["id"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["nombre"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["apellido"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["materia"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["nota"]) . '</td>';
                echo '</tr>';
            }
            echo '</tbody></table>';
        } else {
            echo '<div class="alert alert-info">No se encontraron notas registradas.</div>';
        }
    }

    // Insertar nuevo registro
    if (isset($_POST['insertar'])) {
        $nombre = $_POST['nombre'];
        $apellido = $_POST['apellido'];
        $materia = $_POST['materia'];
        $nota = $_POST['nota'];

        $sql_insert = "INSERT INTO notas (nombre, apellido, materia, nota) VALUES (?, ?, ?, ?)";
        $stmt = $conn->prepare($sql_insert);
        $stmt->bind_param("sssd", $nombre, $apellido, $materia, $nota);

        if ($stmt->execute()) {
            echo '<div class="alert alert-success mt-3">Alumno cargado correctamente.</div>';
        } else {
            echo '<div class="alert alert-danger mt-3">Error al insertar: ' . $conn->error . '</div>';
        }
    }

    $conn->close();
    ?>

    <hr class="mt-5" />

    <!-- Formulario para insertar notas -->
    <div class="mt-4">
        <h2>Ingresar Nota</h2>
        <form action="" method="POST">
            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" name="nombre" placeholder="Ingrese el nombre" required />
            </div>

            <div class="mb-3">
                <label for="apellido" class="form-label">Apellido</label>
                <input type="text" class="form-control" id="apellido" name="apellido" placeholder="Ingrese el apellido" required />
            </div>

            <div class="mb-3">
                <label for="materia" class="form-label">Materia</label>
                <input type="text" class="form-control" id="materia" name="materia" placeholder="Ingrese la materia" required />
            </div>

            <div class="mb-3">
                <label for="nota" class="form-label">Nota</label>
                <input type="number" step="0.01" class="form-control" id="nota" name="nota" placeholder="Ingrese la nota" required />
            </div>

            <button type="submit" name="insertar" class="btn btn-primary">Insertar Datos</button>
        </form>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>





<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Notas - ABM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>

<div class="container mt-4">

    <!-- Botón Cargar Notas -->
    <div class="d-flex justify-content-center mb-4">
        <form method="GET" action="">
            <button type="submit" name="cargar_notas" class="btn btn-primary btn-lg">Cargar Notas</button>
        </form>
    </div>

    <?php
    $conn = new mysqli("localhost", "root", "", "escueladb");
    if ($conn->connect_error) {
        die('<div class="alert alert-danger">Error de conexión: ' . $conn->connect_error . '</div>');
    }

    // Mostrar notas al presionar el botón
    if (isset($_GET['cargar_notas'])) {
        $sql_notas = "SELECT id, nombre, apellido, materia, nota FROM notas ORDER BY id DESC";
        $resultado_notas = $conn->query($sql_notas);

        if ($resultado_notas && $resultado_notas->num_rows > 0) {
            echo '<table class="table table-striped table-bordered mt-4">';
            echo '<thead class="table-dark">';
            echo '<tr><th>ID</th><th>Nombre</th><th>Apellido</th><th>Materia</th><th>Nota</th></tr>';
            echo '</thead><tbody>';
            while ($fila = $resultado_notas->fetch_assoc()) {
                echo '<tr>';
                echo '<td>' . htmlspecialchars($fila["id"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["nombre"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["apellido"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["materia"]) . '</td>';
                echo '<td>' . htmlspecialchars($fila["nota"]) . '</td>';
                echo '</tr>';
            }
            echo '</tbody></table>';
        } else {
            echo '<div class="alert alert-info">No se encontraron notas registradas.</div>';
        }
    }

    // Insertar nuevo registro
    if (isset($_POST['insertar'])) {
        $nombre = $_POST['nombre'];
        $apellido = $_POST['apellido'];
        $materia = $_POST['materia'];
        $nota = $_POST['nota'];

        $sql_insert = "INSERT INTO notas (nombre, apellido, materia, nota) VALUES (?, ?, ?, ?)";
        $stmt = $conn->prepare($sql_insert);
        $stmt->bind_param("sssd", $nombre, $apellido, $materia, $nota);

        if ($stmt->execute()) {
            echo '<div class="alert alert-success mt-3">Alumno cargado correctamente.</div>';
        } else {
            echo '<div class="alert alert-danger mt-3">Error al insertar: ' . $conn->error . '</div>';
        }
    }

    $conn->close();
    ?>

    <hr class="mt-5" />

    <!-- Formulario para insertar notas -->
    <div class="mt-4">
        <h2>Ingresar Nota</h2>
        <form action="" method="POST">
            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" name="nombre" placeholder="Ingrese el nombre" required />
            </div>

            <div class="mb-3">
                <label for="apellido" class="form-label">Apellido</label>
                <input type="text" class="form-control" id="apellido" name="apellido" placeholder="Ingrese el apellido" required />
            </div>

            <div class="mb-3">
                <label for="materia" class="form-label">Materia</label>
                <input type="text" class="form-control" id="materia" name="materia" placeholder="Ingrese la materia" required />
            </div>

            <div class="mb-3">
                <label for="nota" class="form-label">Nota</label>
                <input type="number" step="0.01" class="form-control" id="nota" name="nota" placeholder="Ingrese la nota" required />
            </div>

            <button type="submit" name="insertar" class="btn btn-primary">Insertar Datos</button>
        </form>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>





<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Alumnos - ABM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
<div class="container mt-4">
    <h1 class="mb-4">Lista de Alumnos</h1>
    <a href="index.php" class="btn btn-outline-secondary mb-3">← Volver al Inicio</a>

    <?php
    $conn = new mysqli("localhost", "root", "", "escueladb");
    if ($conn->connect_error) {
        die('<div class="alert alert-danger">Error de conexión: ' . $conn->connect_error . '</div>');
    }

    // Insertar nuevo alumno
    if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['insertar'])) {
        $nombre = trim($_POST['nombre']);
        $apellido = trim($_POST['apellido']);
        $materia = trim($_POST['materia']);
        $nota = trim($_POST['nota']);

        if (empty($nombre) || empty($apellido) || empty($materia) || $nota === '') {
            echo '<div class="alert alert-danger">Por favor, ingresa todos los valores.</div>';
        } elseif (!is_numeric($nota)) {
            echo '<div class="alert alert-warning">La nota debe ser un número válido.</div>';
        } else {
            $sql_insert = "INSERT INTO alumno1 (nombre, apellido, materia, nota) VALUES (?, ?, ?, ?)";
            $stmt = $conn->prepare($sql_insert);
            if ($stmt === false) {
                echo '<div class="alert alert-danger">Error en prepare(): ' . $conn->error . '</div>';
            } else {
                $stmt->bind_param("sssd", $nombre, $apellido, $materia, $nota);
                if ($stmt->execute()) {
                    echo '<div class="alert alert-success">Datos insertados correctamente.</div>';
                } else {
                    echo '<div class="alert alert-danger">Error al insertar los datos: ' . $stmt->error . '</div>';
                }
                $stmt->close();
            }
        }
    }

    // Mostrar tabla con alumnos
    $sql = "SELECT id, nombre, apellido, materia, nota FROM alumno1 ORDER BY id DESC";
    $resultado = $conn->query($sql);

    if ($resultado && $resultado->num_rows > 0) {
        echo '<table class="table table-striped table-bordered mt-4">';
        echo '<thead class="table-dark">';
        echo '<tr><th>ID</th><th>Nombre</th><th>Apellido</th><th>Materia</th><th>Nota</th></tr>';
        echo '</thead><tbody>';
        while ($fila = $resultado->fetch_assoc()) {
            echo '<tr>';
            echo '<td>' . htmlspecialchars($fila["id"]) . '</td>';
            echo '<td>' . htmlspecialchars($fila["nombre"]) . '</td>';
            echo '<td>' . htmlspecialchars($fila["apellido"]) . '</td>';
            echo '<td>' . htmlspecialchars($fila["materia"]) . '</td>';
            echo '<td>' . htmlspecialchars($fila["nota"]) . '</td>';
            echo '</tr>';
        }
        echo '</tbody></table>';
    } else {
        echo '<div class="alert alert-info">No se encontraron alumnos registrados.</div>';
    }

    $conn->close();
    ?>

    <hr class="mt-5" />

    <div class="mt-4">
        <h2>Ingresar Nuevo Alumno</h2>
        <form action="alumnos.php" method="POST">
            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" name="nombre" placeholder="Ingrese el nombre" required />
            </div>

            <div class="mb-3">
                <label for="apellido" class="form-label">Apellido</label>
                <input type="text" class="form-control" id="apellido" name="apellido" placeholder="Ingrese el apellido" required />
            </div>

            <div class="mb-3">
                <label for="materia" class="form-label">Materia</label>
                <input type="text" class="form-control" id="materia" name="materia" placeholder="Ingrese la materia" required />
            </div>

            <div class="mb-3">
                <label for="nota" class="form-label">Nota</label>
                <input type="number" step="0.01" min="0" max="10" class="form-control" id="nota" name="nota" placeholder="Ingrese la nota" required />
            </div>

            <button type="submit" name="insertar" class="btn btn-primary">Insertar Datos</button>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>






<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Alumnos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center mb-4">Lista de Alumnos</h1>

    <?php
    $host = "localhost";
    $usuario = "root";
    $contrasena = "";
    $base_datos = "escueladb";

    $conn = new mysqli($host, $usuario, $contrasena, $base_datos);

    if ($conn->connect_error) {
        die('<div class="alert alert-danger">Conexión fallida: ' . htmlspecialchars($conn->connect_error) . '</div>');
    }

    $editar = false;
    $alumnoEditar = ["nombre" => "", "apellido" => "", "materia" => "", "nota" => ""];
    $id_original = "";

    // Insertar alumno1
    if ($_SERVER["REQUEST_METHOD"] === "POST" && isset($_POST["insertar"])) {
        $nombre = trim($_POST["nombre"]);
        $apellido = trim($_POST["apellido"]);
        $materia = trim($_POST["materia"]);
        $nota = trim($_POST["nota"]);

        if ($nombre !== "" && $apellido !== "" && $materia !== "" && $nota !== "") {
            $nota = floatval($nota);
            $sql = "INSERT INTO alumno1 (nombre, apellido, materia, nota) VALUES (?, ?, ?, ?)";
            $stmt = $conn->prepare($sql);
            $stmt->bind_param("sssd", $nombre, $apellido, $materia, $nota);

            if ($stmt->execute()) {
                echo '<div class="alert alert-success">Alumno agregado correctamente.</div>';
            } else {
                echo '<div class="alert alert-danger">Error: ' . htmlspecialchars($conn->error) . '</div>';
            }
            $stmt->close();
        } else {
            echo '<div class="alert alert-warning">Todos los campos son obligatorios.</div>';
        }
    }

    // Eliminar alumno1
    if ($_SERVER["REQUEST_METHOD"] === "POST" && isset($_POST["eliminar"])) {
        $id_eliminar = intval($_POST["id_eliminar"]);

        $sql = "DELETE FROM alumno1 WHERE id = ?";
        $stmt = $conn->prepare($sql);
        $stmt->bind_param("i", $id_eliminar);
        $stmt->execute();

        if ($stmt->affected_rows > 0) {
            echo '<div class="alert alert-success">Alumno eliminado correctamente.</div>';
        } else {
            echo '<div class="alert alert-warning">No se encontró el alumno.</div>';
        }
        $stmt->close();
    }

    // Obtener alumno1 para edición
    if (isset($_GET["editar"])) {
        $id_editar = intval($_GET["editar"]);
        $sql = "SELECT * FROM alumno1 WHERE id = ?";
        $stmt = $conn->prepare($sql);
        $stmt->bind_param("i", $id_editar);
        $stmt->execute();
        $resultado = $stmt->get_result();

        if ($resultado->num_rows > 0) {
            $editar = true;
            $alumnoEditar = $resultado->fetch_assoc();
            $id_original = $alumnoEditar["id"];
        } else {
            echo '<div class="alert alert-warning">Alumno no encontrado.</div>';
        }
        $stmt->close();
    }

    // Actualizar alumno1
    if ($_SERVER["REQUEST_METHOD"] === "POST" && isset($_POST["actualizar"])) {
        $nuevo_nombre = trim($_POST["nombre"]);
        $nuevo_apellido = trim($_POST["apellido"]);
        $nueva_materia = trim($_POST["materia"]);
        $nueva_nota = trim($_POST["nota"]);
        $id_original = intval($_POST["id_original"]);

        if ($nuevo_nombre !== "" && $nuevo_apellido !== "" && $nueva_materia !== "" && $nueva_nota !== "") {
            $nueva_nota = floatval($nueva_nota);
            $sql = "UPDATE alumno1 SET nombre = ?, apellido = ?, materia = ?, nota = ? WHERE id = ?";
            $stmt = $conn->prepare($sql);
            $stmt->bind_param("sssdi", $nuevo_nombre, $nuevo_apellido, $nueva_materia, $nueva_nota, $id_original);

            if ($stmt->execute()) {
                echo '<div class="alert alert-success">Alumno actualizado correctamente.</div>';
                $editar = false;
                $alumnoEditar = ["nombre" => "", "apellido" => "", "materia" => "", "nota" => ""];
            } else {
                echo '<div class="alert alert-danger">Error al actualizar: ' . htmlspecialchars($conn->error) . '</div>';
            }

            $stmt->close();
        } else {
            echo '<div class="alert alert-warning">Completa todos los campos.</div>';
        }
    }

    // Mostrar tabla de alumno1
    $resultado = $conn->query("SELECT * FROM alumno1 ORDER BY apellido");

    if ($resultado->num_rows > 0) {
        echo '<table class="table table-bordered mt-4">';
        echo '<thead class="table-dark"><tr><th>Nombre</th><th>Apellido</th><th>Materia</th><th>Nota</th><th>Acciones</th></tr></thead><tbody>';

        while ($fila = $resultado->fetch_assoc()) {
            echo '<tr>';
            echo '<td>' . htmlspecialchars($fila["nombre"]) . '</td>';
            echo '<td>' . htmlspecialchars($fila["apellido"]) . '</td>';
            echo '<td>' . htmlspecialchars($fila["materia"]) . '</td>';
            echo '<td>' . number_format($fila["nota"], 2) . '</td>';
            echo '<td>
                    <form method="POST" action="" onsubmit="return confirm(\'¿Eliminar este alumno?\')" style="display:inline-block;">
                        <input type="hidden" name="id_eliminar" value="' . htmlspecialchars($fila["id"]) . '">
                        <button type="submit" name="eliminar" class="btn btn-danger btn-sm">Eliminar</button>
                    </form>
                    <a href="?editar=' . urlencode($fila["id"]) . '" class="btn btn-warning btn-sm ms-2">Editar</a>
                  </td>';
            echo '</tr>';
        }

        echo '</tbody></table>';
    } else {
        echo '<div class="alert alert-info mt-4">No hay alumnos registrados.</div>';
    }

    $conn->close();
    ?>

    <!-- Formulario -->
    <div class="card mt-5">
        <div class="card-header bg-primary text-white">
            <?php echo $editar ? 'Editar Alumno' : 'Agregar Nuevo Alumno'; ?>
        </div>
        <div class="card-body">
            <form method="POST" action="">
                <div class="mb-3">
                    <label for="nombre" class="form-label">Nombre:</label>
                    <input type="text" class="form-control" id="nombre" name="nombre" required value="<?php echo htmlspecialchars($alumnoEditar["nombre"] ?? ''); ?>">
                </div>
                <div class="mb-3">
                    <label for="apellido" class="form-label">Apellido:</label>
                    <input type="text" class="form-control" id="apellido" name="apellido" required value="<?php echo htmlspecialchars($alumnoEditar["apellido"] ?? ''); ?>">
                </div>
                <div class="mb-3">
                    <label for="materia" class="form-label">Materia:</label>
                    <input type="text" class="form-control" id="materia" name="materia" required value="<?php echo htmlspecialchars($alumnoEditar["materia"] ?? ''); ?>">
                </div>
                <div class="mb-3">
                    <label for="nota" class="form-label">Nota:</label>
                    <input type="number" step="0.01" class="form-control" id="nota" name="nota" required value="<?php echo htmlspecialchars($alumnoEditar["nota"] ?? ''); ?>">
                </div>

                <?php if ($editar): ?>
                    <input type="hidden" name="id_original" value="<?php echo htmlspecialchars($id_original); ?>">
                    <button type="submit" name="actualizar" class="btn btn-warning">Actualizar Alumno</button>
                    <a href="?" class="btn btn-secondary ms-2">Cancelar</a>
                <?php else: ?>
                    <button type="submit" name="insertar" class="btn btn-success">Agregar Alumno</button>
                <?php endif; ?>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
